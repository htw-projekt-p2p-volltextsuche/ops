version: "3.7"
services:
    mongo:
        image: mongo
        ports:
            - "8430:27017"
        volumes: 
            - "~/mongo/data:/data/db"
        environment:
            MONGO_INITDB_ROOT_USERNAME: ${MONGO_INITDB_ROOT_USERNAME}
            MONGO_INITDB_ROOT_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD}
    crawler:
        image: zinkl/crawler
        environment:
            MONGO_INITDB_ROOT_USERNAME: ${MONGO_INITDB_ROOT_USERNAME}
            MONGO_INITDB_ROOT_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD}
            MongoConnectionString: "mongodb://${MONGO_INITDB_ROOT_USERNAME}:${MONGO_INITDB_ROOT_PASSWORD}@${MONGO_HOST}:8430"
            IndexingApiEndpoint: ${IndexingApiEndpoint}
    fulltext-search:
        image: zinkl/fulltext-search
        ports:
            - "8421:8421"
    p2pframework:
        image: zinkl/p2p-dht
        ports:
            - "8070:8070"
            - "8090:8090"
        environment:
            PEER_LIST: ${PEER_LIST}
            PEER_IP: ${PEER_IP}
        volumes: 
            - "~/p2p/data:/tmp/datastore"
    userinterface:
        image: zinkl/p2p-userinterface
        ports:
            - "8080:3000"
        environment:
            MONGO_INITDB_ROOT_USERNAME: ${MONGO_INITDB_ROOT_USERNAME}
            MONGO_INITDB_ROOT_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD}
            MCLI_OPS_MANAGER_URL: ${MCLI_OPS_MANAGER_URL}